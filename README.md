# Sieweb Scanlog - Documentation

## Overview

This project is a tool designed for extracting logs and indicators from the SIEWEB application logs. It helps in identifying performance issues, errors, and other important events within the system by scanning and extracting useful information from logs. The tool is actively under development, and some bugs may still be present.

## Table of Contents

- [Introduction](#introduction)
- [How It Works](#how-it-works)
- [Log Extractors and Indicators](#log-extractors-and-indicators)
- [Configuration Parameters](#configuration-parameters)
- [Usage](#usage)
- [Development and Contribution](#development-and-contribution)
- [History](#history)

## Introduction

The **sieweb-scanlog** tool extracts valuable insights from logs generated by SIEWEB-based portals. By instrumenting the logs with detailed and consistent information, such as the `document portal` and `Pix recharge functionality`, it allows for the extraction of important metrics, error detection, and other key performance indicators (KPIs).

## How It Works

The **sieweb-scanlog** tool uses a series of log extractors and indicators to identify patterns in log entries. The tool is divided into several classes that handle different types of log analysis:

- **Extractors**: Simple text-based extractors that search for specific patterns in logs.
- **Counters**: Basic indicators that count occurrences of certain patterns.
- **Regex-based Counters**: Indicators based on regular expressions for more complex pattern matching.
- **Accumulators**: Indicators that accumulate values from patterns in logs, often used for tracking counts or sums.
- **Conditional Counters**: Indicators based on conditional patterns that need to be matched with specific criteria.
- **Business Message Extractors**: Extracts all user-facing messages displayed by the system.

## Log Extractors and Indicators

To ensure accurate extraction and meaningful insights, the logs must be instrumented with structured patterns. These patterns include fixed text or terms that allow the tool to easily identify and extract relevant information. The tool processes these logs and generates reports on various KPIs, including errors, performance metrics, and transaction statuses.

### Key Types of Extractors and Indicators

1. **Log Extractors**: Used for extracting specific log entries based on fixed text patterns.
2. **Simple Text Counters**: These indicators count occurrences of a specific text pattern in the logs.
3. **Regex Counters**: These use regular expressions to match more complex patterns.
4. **Accumulators**: These indicators accumulate values based on specific patterns, useful for tracking counts over time.

## Configuration Parameters

### Log Extractors (`extratoresArray`)

These parameters define the log extractors, specifying the pattern to search for, how many lines before and after to display, and the file where the results will be saved.

Example:
```
[PERFORMANCE]|0|0|alert_performance_warning.log
MUITO ALTO (>5s)|0|0|alert_serializacao_muito_alto.log
NullPointerException|24|2|null_pointer_exceptions.log
...
```

### Simple Text Counters (`contadoresArray`)

These parameters define the text patterns to search for in logs and the corresponding messages for the indicators.

Example:
```
'Usuário válido autenticado|logins SIE bem sucedidos'
'javax.security.auth.login.FailedLoginException: |logins com falha (usuário/senha inválidos)'
'AccountExpiredException|logins com falha porque a conta está bloqueada'
...
```

### Regex-Based Counters (`contadoresRegexArray`)

This section defines patterns using regular expressions to match complex log entries. These are used for indicators that require pattern matching flexibility.

Example:
```
'iniciando download arquivo [0-9]* do repositório#downloads do bucket independente de formato de arquivo'
'iniciando download arquivo [0-9]* do repositório\. TipoArquivo: video/mp4#downloads video/mp4 do bucket'
...
```

### Accumulators (`acumuladoresArray`)

These parameters define patterns to search for in logs, along with the patterns used to accumulate values, and the corresponding message for the indicator.

Example:
```
"Processamento encerrado. [0-9]{1,3} notificações processadas|[0-9]{1,3}|timer/notificações processadas"
"Buscando [0-9]{1,3} mensagens a enviar|[0-9]{1,3}|e-mails enviados via MensagemTimerBean"
...
```

## Usage

### Running the Tool

1. **Install Dependencies**: Make sure all required dependencies for the log extraction tool are installed. This may include utilities for regex processing and log file access.
2. **Configure Extractors**: Ensure that the `extratoresArray`, `contadoresArray`, `contadoresRegexArray`, and `acumuladoresArray` arrays are properly configured based on your log structure.
3. **Run the Script**: Execute the tool with the required parameters, and it will scan the logs, generate the indicators, and save the results in the specified files.

### Example Command

```bash
./sieweb-scanlog.sh
```

The script will process the logs according to the defined patterns and generate the respective output files.

## Development and Contribution

### Contributing

If you would like to contribute to the development of **sieweb-scanlog**, please fork the repository, make changes, and submit a pull request. Contributions that improve the tool?s ability to extract more comprehensive indicators or add new types of extractors are highly encouraged.

### Reporting Issues

If you encounter bugs or have feature requests, please open an issue on the GitHub repository. Be sure to provide detailed steps to reproduce the issue or a description of the desired feature.

## History

| Date       | Author             | Message                           |
|------------|--------------------|-----------------------------------|
| 10/08/2024 | Everton Agilar     | Initial version                   |

---

For more information, please refer to the project documentation and the configuration files.